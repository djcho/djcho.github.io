---
title : "[JPA] DDL"
categories:
- JPA
tag :
- [Java, ORM, JPA, Hibernate, DDL]
toc: true
toc_sticky : true
published : true
date : 2023-01-07 00:00:00
last_modified_at : 2023-01-07 00:00:00
---

ê¹€ì˜í•œë‹˜ì´ ì§€ìŒ, [ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°] ì±…ì„ ì½ê³  ì •ë¦¬í•œ í•„ê¸°ì…ë‹ˆë‹¤.ğŸ“¢
{: .notice--warning}



# DDL(Data Definition Language)

DDLì´ë€ JPAê°€ Entity í´ë˜ìŠ¤ë¥¼ í™•ì¸í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ê¸°ëŠ¥

- ë§¤í•‘ ì •ë³´ì™€ ë°ì´í„°ë² ì´ìŠ¤ ë°©ì–¸ì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤í‚¤ë§ˆ ìƒì„±
- ê°œë°œìê°€ í…Œì´ë¸”ì„ ì§ì ‘ ìƒì„±í•˜ëŠ” ìˆ˜ê³ ë¥¼ ëœ ìˆ˜ ìˆìŒ
- But, ìš´ì˜ í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ë§Œí¼ ì™„ë²½í•˜ì§€ ì•ŠìŒ â†’ ì°¸ê³ ìš©ìœ¼ë¡œë§Œ ì‚¬ìš© ê¶Œì¥
    - ê°œë°œ ì´ˆê¸° ë‹¨ê³„ëŠ” create ë˜ëŠ” update
    - ì´ˆê¸°í™” ìƒíƒœë¡œ ìë™í™” í…ŒìŠ¤íŠ¸ í™˜ê²½ì€ create ë˜ëŠ” create-drop
    - í…ŒìŠ¤íŠ¸ ì„œë²„ëŠ” update ë˜ëŠ” validate
    - ìŠ¤í…Œì´ì§•ê³¼ ìš´ì˜ ì„œë²„ëŠ” validate ë˜ëŠ” none



## `hibernate.hbm2ddl.auto` ì†ì„±

| ì˜µì…˜        | ì„¤ëª…                                                         |
| ----------- | ------------------------------------------------------------ |
| create      | ê¸°ì¡´ í…Œì´ë¸”ì„ ì‚­ì œí•˜ê³  ìƒˆë¡œ ìƒì„±, DROP + CREATE              |
| create-drop | Create ì†ì„±ì— ì¶”ê°€ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¢…ë£Œí•  ë•Œ ìƒì„±í•œ DDLì„ ì œê±°, DROP + CREATE+ DROP |
| update      | ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ ì—”í‹°í‹° ë§¤í•‘ì •ë³´ë¥¼ ë¹„êµí•´ì„œ ë³€ê²½ ì‚¬í•­ë§Œ ìˆ˜ì • |
| validate    | ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ê³¼ ì—”í‹°í‹° ë§¤í•‘ì •ë³´ë¥¼ ë¹„êµí•´ì„œ ì°¨ì´ê°€ ìˆìœ¼ë©´ ê²½ê³ ë¥¼ ë‚¨ê¸°ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ ì„¤ì •ì€ DDLì„ ìˆ˜ì •í•˜ì§€ ì•ŠëŠ”ë‹¤. |
| none        | ìë™ ìƒì„± ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´ hibernate.hbm2ddl.auto ì†ì„± ìì²´ë¥¼ ì‚­ì œí•˜ê±°ë‚˜ ìœ íš¨í•˜ì§€ ì•Šì€ ì˜µì…˜ ê°’ì„ ì£¼ë©´ ëœë‹¤. (none == ìœ íš¨í•˜ì§€ ì•Šì€ ê°’) |



## DDL ìƒì„± ê¸°ëŠ¥

`@Column` ë§¤í•‘ ì •ë³´ì˜ ì†ì„± ê°’ìœ¼ë¡œ í…Œì´ë¸”ì˜ ì œì•½ ì¡°ê±´ì„ ì¶”ê°€í•  ìˆ˜ ìˆìŒ

- `nullable = false` : í…Œì´ë¸”ì˜ not null ì œì•½ ì¡°ê±´ ì¶”ê°€
- `length` : ì»¬ëŸ¼ ë°ì´í„°ì˜ ê¸¸ì´ ì œì•½ ì¶”ê°€

```java
@Entity
@Table(name="MEMBER")
public class Member{
    @Id
    @Column(name = "ID")
    private String id;

    @Column(name = "NAME", nullable = false, length = 10) //ì¶”ê°€
    private String username;
    ...
}
```

```sql
create table MEMBER (
   ID varchar(255) not null,
    age integer,
    createdDate datetime,
    description longblob,
    lastModifiedDate datetime,
    roleType varchar(255),
    NAME varchar(10) not null, #ì¶”ê°€ ë¨
    primary key (ID)
) engine=InnoDB
```



ìœ ë‹ˆí¬ ì œì•½ì¡°ê±´ ìƒì„±

```java
@Entity
@Table(name="MEMBER", uniqueConstraints = {@UniqueConstraint(
        name = "NAME_AGE_UNIQUE",
        columnNames = {"NAME", "AGE"}
)})
public class Member {
    @Id
    @Column(name = "ID")
    private String id;

    @Column(name = "NAME", nullable = false, length = 10)
    private String username;
    ...
}
```

```
Hibernate:    
    alter table MEMBER 
       add constraint NAME_AGE_UNIQUE unique (NAME, age)
```

**ìœ„ì™€ ê°™ì€ ê¸°ëŠ¥ë“¤ì€ ë‹¨ì§€ DDLì„ ìë™ìœ¼ë¡œ ìƒì„±í•  ë•Œë§Œ ì‚¬ìš©ë˜ê³  JPAì˜ ì‹¤í–‰ ë¡œì§ì—ëŠ” ì˜í–¥ì„ ì£¼ì§€ ì•ŠëŠ”ë‹¤.**

